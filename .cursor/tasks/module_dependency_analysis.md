# 모듈 의존성 분석 계획서

## 개요

이 문서는 프로젝트의 모듈 간 의존성을 분석하고, 클린 아키텍처 원칙에 따라 의존성 방향이 적절한지 검증하기 위한 계획을 설명합니다. 특히 UseCase 리팩토링 이후 각 모듈의 의존성 구조가 개선되었는지 검증합니다.

## 분석 목표

1. 모듈 간 의존성 방향이 클린 아키텍처 원칙에 부합하는지 확인
2. 불필요한 의존성이나 순환 의존성 식별
3. 각 계층(Domain, Data, Feature)이 적절한 의존성만 가지고 있는지 검증
4. 모듈 간 경계가 명확하게 유지되고 있는지 확인

## 의존성 방향 정책

클린 아키텍처에 따른 의존성 방향은 다음과 같아야 합니다:

```
UI → ViewModel → UseCase → Repository → DataSource
```

각 계층은 자신보다 내부(안쪽)에 있는 계층에만 의존해야 하며, 외부(바깥쪽) 계층에 대한 의존성이 있어서는 안 됩니다.

## 모듈별 의존성 규칙

### Domain 모듈 (`domain`)
- **허용된 의존성**: 없음 (코어 Kotlin 라이브러리만 사용)
- **금지된 의존성**: `data`, `feature`, 안드로이드 프레임워크

### Data 모듈 (`data`)
- **허용된 의존성**: `domain`, 코어 라이브러리
- **금지된 의존성**: `feature`, 안드로이드 UI 관련 라이브러리

### Feature 모듈 (`feature_*`)
- **허용된 의존성**: `domain`, 코어 라이브러리, UI 라이브러리
- **금지된 의존성**: `data`, 다른 `feature_*` 모듈 (Navigation 모듈을 통해 간접적으로만 참조)

### 공통 모듈 (`core_*`)
- **허용된 의존성**: 라이브러리, 관련 프레임워크
- **금지된 의존성**: `feature_*`, `data`, `domain` (기능적 의존성 없어야 함)

## 분석 방법

### 1. 정적 분석 도구 사용
- Gradle 의존성 그래프 생성 및 분석
- 의존성 시각화 도구 활용 (예: Graphviz)

### 2. 코드 검토
- `build.gradle` 파일에서 선언된 의존성 확인
- import 문 분석으로 실제 사용되는 의존성 확인
- 패키지 간 참조 패턴 검토

### 3. 테스트 케이스
- 계층 간 의존성 경계가 잘 지켜지는지 확인하는 테스트 작성

## 중점 검토 영역

### 1. ViewModel 의존성
- 모든 ViewModel이 Repository 대신 UseCase만 의존하는지 확인
- Feature 모듈이 Data 모듈에 직접 의존하지 않는지 확인

### 2. UseCase 의존성
- UseCase가 Repository 인터페이스에만 의존하는지 확인
- 추가적인 비즈니스 로직이 필요한 경우 다른 UseCase를 의존성으로 받는지 확인

### 3. Repository 의존성
- Repository 구현체가 DataSource에 의존하는지 확인
- DataSource와 DTO 변환 로직만 포함하고 있는지 확인

### 4. 모듈 간 의존성
- `domain` → 다른 모듈 의존성 없음
- `data` → `domain`
- `feature_*` → `domain`
- `feature_*` → `data` 의존성 없음

## 예상 결과물

1. 모듈 의존성 그래프 및 시각화 자료
2. 의존성 위반 사례 목록 (발견 시)
3. 개선 권장사항 목록
4. 모듈 간 의존성 매트릭스

## 모듈별 의존성 체크리스트

### Domain 모듈
- [ ] 외부 프레임워크 의존성 없음
- [ ] 안드로이드 의존성 최소화 (필요 시 추상화)
- [ ] `data` 모듈에 대한 의존성 없음
- [ ] `feature` 모듈에 대한 의존성 없음

### Data 모듈
- [ ] `domain` 모듈에만 의존
- [ ] Repository 인터페이스 구현
- [ ] DTO ↔ Domain Model 변환 로직 포함
- [ ] `feature` 모듈에 대한 의존성 없음

### Feature 모듈
- [ ] `domain` 모듈에만 의존 (UseCase, Model)
- [ ] `data` 모듈에 대한 직접 의존성 없음
- [ ] 다른 `feature` 모듈에 대한 직접 의존성 없음
- [ ] ViewModel이 Repository 직접 참조하지 않음

## 지속적 모니터링 방안

1. CI/CD 파이프라인에 의존성 검증 스크립트 추가
2. 정기적인 아키텍처 검토 회의 실시
3. 새로운 모듈 추가 시 의존성 방향 가이드라인 준수 검증 